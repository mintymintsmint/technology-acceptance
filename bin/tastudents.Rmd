---
title: "Data Analysis on Students' Technology Acceptance of Moodle and Academic Discipline"
author: "Laura Reinhardt"
date: "2024-04-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Analysis on Students' Technology Acceptance of Moodle and Academic Discipline


```{r data}
#install.packages("here")
library(here)
here()
data <- read.csv2(here("data", "data_tastudents.csv"), encoding="UTF-8", fileEncoding="latin1")
```
I have read in the data after having manually deleted unnecessary columns via Excel (time spent per page, and so on.)

```{r dimensions}
dim(data)
str(data)
```

```{r NA}
anyNA(data) # no initial NA values

for (i in 1:nrow(data)) { # loop through all rows and columns to replace empty values that are coded as -9 as actual NA that are recognized by R
  for (j in 1:ncol(data)) {
    if (data[i, j] == -9) {
      data[i, j] <- NA
    }
  }
}
```

```{r}
anyNA(data)
colSums(is.na(data))
```
One person didn't select what type of degree they are pursuing, two people did not select their gender and one person did not disclose their age. Since I cannot afford to lose their other replies, I will add an extra level "other" to these three columns. First, of course, I have to change the class of the columns to factors first.

```{r column_names}
colnames(data)[1] <- "ID"
colnames(data)
```
First, I changed the name of the first column to ID, since the name seems to have gotten corrupted during the import process.

```{r}
str(data)
```
```{r}
data$AD01 <- factor(data$AD01)
data$AD02 <- factor(data$AD02)
data$AD03 <- factor(data$AD03)
data$AU01_01 <- factor(data$AU01_01)
data$AU01_02 <- factor(data$AU01_02)
data$AU01_03 <- factor(data$AU01_03)
data$AU02 <- factor(data$AU02)
data$DE02 <- factor(data$DE02)
data$DE03 <- factor(data$DE03)

str(data)
```
 
Now I will treat the missing data that was previously found. NA are in the columns AD02, DE02 and DE03

```{r}
levels(data$AD02) <- c(levels(data$AD02), "Other")
levels(data$DE02) <- c(levels(data$DE02), "Other")
levels(data$DE03) <- c(levels(data$DE03), "Other")

data$AD02[is.na(data$AD02)] <- "Other"
data$DE02[is.na(data$DE02)] <- "Other"
data$DE03[is.na(data$DE03)] <- "Other"

colSums(is.na(data))
```
The missing data has been successfully dealt with. Now I want to find the average values of attitude towards using Moodle, actual use of Moodle, behavioral intention to use Moodle, perceived ease of use, perceived usefulness and voluntariness.

```{r}
str(data)
data$AT <- rowMeans(data[,5:8])
data$BI <- rowMeans(data[,13:17])
data$PE <- rowMeans(data[,21:26])
data$PU <- rowMeans(data[,27:32])
data$VU <- rowMeans(data[,33:35])
head(data)
```
Now I will plot the voluntariness of Moodle.
```{r}
#install.packages("pacman", repos = "http://cran.us.r-project.org")
library(pacman)
p_load(RColorBrewer, # color pallets
       ggplot2,      # prettier graphs 
       cowplot,      # arranges ggplot graphs nicely
       moments,       # for calculating skeweness
       scales
       )
```

```{r voluntariness}
plot_vol <- ggplot(data, aes(VU) ) +
              geom_histogram(na.rm = T,
                             colour = "dodgerblue4",  # contour color
                             fill   = "forestgreen",  # fill/insides color
                             bins  = 40) +  
              xlim(1,5) +
              ylim(0,15) +
              labs(y = "Frequency",
                   x = "Voluntariness of Moodle Use",
                   caption = "Data: umfrage.up",
                   title = "Histogram of the Voluntariness of Moodle Use") + 
              theme(plot.title    = element_text(color = "royalblue4", hjust = 0.5,
                                     size = 12, face = "bold"),
              plot.caption  = element_text(face = "italic")  # text formatting
              )
```
Almost half of all participants say that use of Moodle is mandated, which means that for the investigation between academic discipline and technology acceptance, using the variable "actual use of Moodle" is not helpful as students can not choose to not use it. This means that high usage can't indicate high acceptance. Instead, I will use perceived ease of use and perceived usefulness. I will also not use behavioral intention to use Moodle since this too is influenced by the lack of voluntariness. 

*add graph to show relationship between voluntariness and actual use / behavioral intention to use*

```{r fig.width=12}
data$AD03 <- factor(data$AD03,
                    levels = c(1,2,3,4,5,6,7,8,9,10),
                    labels = c("Computer Science","Economics","Educational and Cognitive Sciences","Humanities, Cultural Sciences and Theology","Law","Mathematics","Natural Sciences","Psychology","Social Sciences","Sports and Health Science")
                    )

plot_ad_dis <- ggplot(data, aes(x = AD03, fill = AD03)) + 
                geom_bar(position = "dodge") + # elements one next to the other
                labs(title = "Distribution of Academic Discpline",
                     x = "Academic Discipline",
                     y = "Count") +
                scale_x_discrete(labels = label_wrap(10)) +
                scale_fill_brewer(palette = "Set3") +
                theme(plot.title    = element_text(color = "royalblue4", 
                                                   size = 12, face = "bold"),
                plot.caption  = element_text(face = "italic")
                )
```
```{r}
hist1 <- ggplot(data, aes(PE) ) +
            geom_histogram(na.rm = T,
                           colour = "dodgerblue4",  # contour color
                           fill   = "forestgreen",  # fill/insides color
                           bins  = 25) +  # alternatively use: binwidth = <width>
            xlim(1,5) +
            labs(y = "Frequency",
                 x = "Perceived Ease of Use",
                 caption = "Data: umfrage.up",
                 title = "Histogram of Perceived Ease of Use of Moodle") +
            theme(plot.title    = element_text(color = "royalblue4", hjust = 0.5,
                                               size = 10, face = "bold"),
                  plot.caption  = element_text(face = "italic")  # text formatting
                  )

hist2 <- ggplot(data, aes(PU) ) +
            geom_histogram(na.rm = T,
                           colour = "dodgerblue4",  # contour color
                           fill   = "forestgreen",  # fill/insides color
                           bins  = 25) +  # alternatively use: binwidth = <width>
            xlim(1,5) +
            labs(y = "Frequency",
                 x = "Perceived Usefulness",
                 caption = "Data: umfrage.up",
                 title = "Histogram of Perceived Usefulness of Moodle") +
            theme(plot.title    = element_text(color = "royalblue4", hjust = 0.5,
                                               size = 10, face = "bold"),
                  plot.caption  = element_text(face = "italic")  # text formatting
                  )

plot_grid(hist1, hist2, ncol = 2)  # cowplot package
```
```{r fig.width=12}
plot_AD_PE <- ggplot(data, aes(x = AD03, y = PE, fill = AD03) )+
                geom_boxplot(coef = 2,  # length of whiskers
                             notchwidth = 0.5,
                             outlier.stroke = 0.7,  # boldness of outliers 
                             outlier.size   = 1,      
                             outlier.colour = "coral2",  
                             outlier.shape  = 25  # 25 - triangles, nice shape
                             ) +
                ylim(1,5) +
                scale_x_discrete(labels = label_wrap(10)) +
                scale_color_brewer(type = "qual", palette = 2) +
                labs(title = "Perceived Ease of Use by Academic Discipline",
                     x = "Academic Discipline",
                     y = "Perceived Ease of Use",
                     caption = "Data: umfrage.up") +
                theme(plot.title    = element_text(color = "royalblue4", size = 12, face = "bold"),
                      plot.caption  = element_text(face = "italic")
                      )
```

```{r PU, fig.width=12}
plot_AD_PU <- ggplot(data, aes(x = AD03, y = PU, fill = AD03) )+
                geom_boxplot(coef = 2,  # length of whiskers
                             notchwidth = 0.5,
                             outlier.stroke = 0.7,  # boldness of outliers 
                             outlier.size   = 1,      
                             outlier.colour = "coral2",  
                             outlier.shape  = 25  # 25 - triangles, nice shape
                             ) +
                ylim(1,5) +
                scale_x_discrete(labels = label_wrap(10)) +
                scale_color_brewer(type = "qual", palette = 3) +
                labs(title = "Perceived Usefulness by Academic Discipline",
                     x = "Academic Discipline",
                     y = "Perceived Usefulness",
                     caption = "Data: umfrage.up") +
                theme(plot.title    = element_text(color = "royalblue4", size = 12, face = "bold"),
                      plot.caption  = element_text(face = "italic")
                      )
```
TODO: Average PE / PU by academic discipline, Ãœbersichtstabelle mit allen aufgenommenen Werten a la summary(data), Hypothesenvalidierung, alle figures abspeichern     

```{r fig.width=8}
PE_mean <- aggregate(PE~AD03, data = data, mean)
PE_mean <- PE_mean[order(PE_mean$PE),]
PE_mean

PU_mean <- aggregate(PU~AD03, data = data, mean)
PU_mean <- PU_mean[order(PU_mean$PU),]
PU_mean

plot_AD_avgPE <- ggplot(PE_mean, aes(x = AD03, y = PE)) +
                  geom_point(na.rm = T) +
                  ylim(1,5) +
                  scale_x_discrete(limits = c("Mathematics","Educational and Cognitive Sciences","Humanities, Cultural Sciences and Theology","Economics","Social Sciences","Psychology","Computer Science","Natural Sciences","Law"),
                                   labels = label_wrap(10)) +
                  labs(title = "Average Perceived Ease of Use by Academic Discipline",
                       x = "Academic Discipline",
                       y = "Average Perceived Ease of use",
                       caption = "Data: umfrage.up") +
                  theme(plot.title    = element_text(color = "royalblue4", size = 12, face = "bold"),
                        plot.caption  = element_text(face = "italic")
                        )

plot_AD_avgPU <- ggplot(PU_mean, aes(x = AD03, y = PU)) +
                  geom_point(na.rm = T) +
                  ylim(0,5) +
                  scale_x_discrete(limits = c("Humanities, Cultural Sciences and Theology","Social Sciences","Economics","Natural Sciences","Mathematics","Educational and Cognitive Sciences","Computer Science","Law","Psychology"),
                                   labels = label_wrap(10)) +
                  labs(title = "Average Perceived Usefulness by Academic Discipline",
                       x = "Academic Discipline",
                       y = "Average Perceived Usefulness",
                       caption = "Data: umfrage.up") +
                  theme(plot.title    = element_text(color = "royalblue4", size = 12, face = "bold"),
                        plot.caption  = element_text(face = "italic")
                        )
```
Now we investigate the relationship between average PE and PU pe academic discipline.
```{r}
AD_PE_PU <- aggregate(PE~AD03, data = data, mean)
PU_temp <- aggregate(PU~AD03, data = data, mean)
AD_PE_PU$PU <- PU_temp$PU

plot_PE_PU <- ggplot(AD_PE_PU, aes(x = PE, y = PU)) +
                geom_point(na.rm = T) +  # a layer of points
                geom_smooth(na.rm = T,
                            method = "lm",   # linear model
                            se = F,
                            colour = "coral3",
                            show.legend = T) + 
                labs(title = "Relationship between Average Perceived Ease of Use and Average Perceived Usefulness",
                     caption = "Data: umfrage.up",
                     x = "Perceived Ease of Use",
                     y = "Perceived Usefulness") +
                theme(plot.title = element_text(color = "royalblue4", size = 10, face = "bold"),
                      plot.caption  = element_text(face = "italic"))
```


Now I will save the figures in a separate "results" folder.

```{r}
ggsave("histPE.png", plot = hist1, path = here("results"))
ggsave("histPU.png", plot = hist2, path = here("results"))
ggsave("plot_AD_avgPE.png", plot = plot_AD_avgPE, path = here("results"))
ggsave("plot_AD_avgPU.png", plot = plot_AD_avgPU, path = here("results"))
ggsave("plot_ad_dis.png", plot = plot_ad_dis, path = here("results"), width = 12)
ggsave("plot_AD_PE.png", plot = plot_AD_PE, path = here("results"), width = 12)
ggsave("plot_AD_PU.png", plot = plot_AD_PU, path = here("results"), width = 12)
ggsave("plot_PE_PU.png", plot = plot_PE_PU, path = here("results"))
ggsave("plot_vol.png", plot = plot_vol, path = here("results"))
```

